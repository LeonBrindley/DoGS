%% Function: Validate a scalar.
function Value = ValidateScalar(Value, Criteria, Name, PreviousValue)
    %% 1. Determine whether a previous value is defined.
    HasPreviousValue = (nargin >= 4 && ~isempty(PreviousValue));
    FailureMessage = '';
    %% 2. Validate that the input is a finite scalar.
    if(~isscalar(Value) || ~isnumeric(Value) || ~isfinite(Value))
        FailureMessage = 'is not a finite scalar.';
    end
    %% 2. Enforce any further constraints.
    if(isempty(FailureMessage))
        switch Criteria
            case 'Positive'
                if(Value <= 0)
                    FailureMessage = 'is not a positive scalar.';
                end
            case 'Negative'
                if(Value >= 0)
                    FailureMessage = 'is not a negative scalar.';
                end
            case 'PositiveInteger'
                if(Value <= 0 || mod(Value, 1) ~= 0)
                    FailureMessage = 'must be a positive integer.';
                end
            case 'NegativeInteger'
                if(Value >= 0 || mod(Value, 1) ~= 0)
                    FailureMessage = 'must be a negative integer.';
                end
            case 'NonPositive'
                if(Value > 0)
                    FailureMessage = 'must be a non-positive scalar.';
                end
            case 'NonNegative'
                if(Value < 0)
                    FailureMessage = 'must be a non-negative scalar.';
                end
        end
    end
    %% 3. Use the previous value or throw an error on failure.
    if(~isempty(FailureMessage))
        if(~HasPreviousValue)
            error('%s %s No previous value is defined.', Name, FailureMessage);
        end
        warning('%s %s Switched to previous value.', Name, FailureMessage);
        Value = PreviousValue;
    end
end